import{g as h,u as p,b as v,r as a,j as e,L as f,s as j}from"./index-s1Im0gGd.js";import{L as g}from"./LeaveReviewForm-giRhknTP.js";import{S as N}from"./server-crash-DZrP2UOO.js";import"./Alert-DQovq92X.js";import"./star-28KIeG3b.js";function I(){const{transactionId:r}=h(),{user:t}=p(),o=v(),[s,d]=a.useState(null),[l,m]=a.useState(!0),[n,x]=a.useState("");if(a.useEffect(()=>{(async()=>{if(r)try{const{data:i,error:c}=await j.from("transactions").select("id, sender_id, traveler_id").eq("id",r).single();if(c)throw c;d(i)}catch{x("Impossible de charger les détails de la transaction.")}finally{m(!1)}})()},[r]),l)return e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(f,{className:"w-12 h-12 text-primary animate-spin"})});if(n||!s)return e.jsxs("div",{className:"min-h-screen bg-neutral-50 py-12 px-4 text-center",children:[e.jsx(N,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-red-700",children:"Erreur"}),e.jsx("p",{className:"text-red-600 mt-2",children:n||"Transaction non trouvée."})]});const u=(t==null?void 0:t.id)===s.sender_id?s.traveler_id:s.sender_id;return e.jsx("div",{className:"min-h-screen bg-neutral-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-neutral-800",children:"Laisser un avis"}),e.jsx("p",{className:"text-lg text-neutral-600 mt-2",children:"Partagez votre expérience pour aider la communauté."})]}),e.jsx("div",{className:"bg-white rounded-4xl shadow-xl p-8",children:t&&e.jsx(g,{transactionId:s.id,revieweeId:u,reviewerId:t.id,onReviewSubmitted:()=>o("/dashboard")})})]})})}export{I as LeaveReviewPage};
