import{u as B,b as P,r as o,j as e,B as D,s as G}from"./index-s1Im0gGd.js";import{I as l}from"./Input-BKp795_O.js";import{A as k}from"./Alert-DQovq92X.js";import{c as V,S as h}from"./countries_cities-BAqQKpta.js";import{B as S}from"./briefcase-DOTPYjiq.js";import{M as q}from"./map-pin-CGMQsRrg.js";import{C as z}from"./calendar-8PhAnDAA.js";import{W as T}from"./weight-h7E0NLn2.js";const U=[{code:"AED",name:"Dirham des É.A.U."},{code:"AOA",name:"Kwanza Angolais"},{code:"AUD",name:"Dollar Australien"},{code:"BIF",name:"Franc Burundais"},{code:"BRL",name:"Réal Brésilien"},{code:"BWP",name:"Pula Botswanais"},{code:"CAD",name:"Dollar Canadien"},{code:"CDF",name:"Franc Congolais"},{code:"CHF",name:"Franc Suisse"},{code:"CNY",name:"Yuan Chinois"},{code:"CVE",name:"Escudo Cap-Verdien"},{code:"DJF",name:"Franc Djiboutien"},{code:"DZD",name:"Dinar Algérien"},{code:"EGP",name:"Livre Égyptienne"},{code:"ERN",name:"Nakfa Érythréen"},{code:"ETB",name:"Birr Éthiopien"},{code:"EUR",name:"Euro"},{code:"GBP",name:"Livre Sterling"},{code:"GHS",name:"Cedi Ghanéen"},{code:"GMD",name:"Dalasi Gambien"},{code:"GNF",name:"Franc Guinéen"},{code:"INR",name:"Roupie Indienne"},{code:"JPY",name:"Yen Japonais"},{code:"KES",name:"Shilling Kenyan"},{code:"KMF",name:"Franc Comorien"},{code:"LRD",name:"Dollar Libérien"},{code:"LSL",name:"Loti Lesothan"},{code:"LYD",name:"Dinar Libyen"},{code:"MAD",name:"Dirham Marocain"},{code:"MGA",name:"Ariary Malgache"},{code:"MRU",name:"Ouguiya Mauritanien"},{code:"MUR",name:"Roupie Mauricienne"},{code:"MWK",name:"Kwacha Malawite"},{code:"MZN",name:"Metical Mozambicain"},{code:"NAD",name:"Dollar Namibien"},{code:"NGN",name:"Naira Nigérian"},{code:"RWF",name:"Franc Rwandais"},{code:"RUB",name:"Rouble Russe"},{code:"SAR",name:"Riyal Saoudien"},{code:"SCR",name:"Roupie Seychelloise"},{code:"SDG",name:"Livre Soudanaise"},{code:"SLE",name:"Leone Sierra-Léonais"},{code:"SOS",name:"Shilling Somali"},{code:"SSP",name:"Livre Sud-Soudanaise"},{code:"STN",name:"Dobra Santoméen"},{code:"SZL",name:"Lilangeni Swazi"},{code:"TND",name:"Dinar Tunisien"},{code:"TZS",name:"Shilling Tanzanien"},{code:"UGX",name:"Shilling Ougandais"},{code:"USD",name:"Dollar Américain"},{code:"XAF",name:"Franc CFA (BEAC)"},{code:"XOF",name:"Franc CFA (BCEAO)"},{code:"ZAR",name:"Rand Sud-Africain"},{code:"ZMW",name:"Kwacha Zambien"},{code:"ZWL",name:"Dollar Zimbabwéen"}].sort((c,d)=>c.name.localeCompare(d.name));function Z(){const{user:c}=B(),d=P(),[r,m]=o.useState({title:"",description:"",departure_city:"",departure_country:"",arrival_city:"",arrival_country:"",departure_date:"",arrival_date:"",available_weight:"",price_per_kg:"",currency:"XOF"}),[v,w]=o.useState([]),[A,g]=o.useState(!1),[y,u]=o.useState(""),[F,E]=o.useState(!1);o.useEffect(()=>{const a=[...V].sort((n,t)=>n.name.localeCompare(t.name));w(a)},[]);const i=a=>{const{name:n,value:t}=a.target;m(s=>({...s,[n]:t}))},b=(a,n)=>{const t=a.target.value;m(n==="departure"?s=>({...s,departure_country:t,departure_city:""}):s=>({...s,arrival_country:t,arrival_city:""}))},L=async a=>{if(a.preventDefault(),!c){u("Vous devez être connecté pour publier un voyage.");return}g(!0),u("");try{const{title:n,departure_city:t,departure_country:s,arrival_city:j,arrival_country:f,departure_date:p,arrival_date:x,available_weight:N,price_per_kg:_,currency:R}=r;if(!n||!t||!s||!j||!f||!p||!x||!N||!_)throw new Error("Veuillez remplir tous les champs obligatoires.");if(new Date(x)<=new Date(p))throw new Error("La date d'arrivée doit être postérieure à la date de départ.");const M={traveler_id:c.id,title:n,description:r.description||null,departure_city:t,departure_country:s,arrival_city:j,arrival_country:f,departure_date:p,arrival_date:x,available_weight:parseFloat(N),price_per_kg:parseFloat(_),currency:R,status:"AVAILABLE"},{error:C}=await G.from("trips").insert([M]);if(C)throw C;E(!0),setTimeout(()=>d("/dashboard"),2e3)}catch(n){u(n.message||"Une erreur est survenue lors de la publication de votre voyage.")}finally{g(!1)}};return F?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(S,{className:"w-8 h-8 text-green-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-neutral-800 mb-2",children:"Voyage publié avec succès !"}),e.jsx("p",{className:"text-neutral-600 mb-4",children:"Votre voyage est maintenant visible. Vous serez notifié des demandes de transport."}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Redirection vers le tableau de bord..."})]}):e.jsxs("form",{onSubmit:L,className:"space-y-8",children:[y&&e.jsx(k,{type:"error",message:y}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(S,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800",children:"Détails du voyage"})]}),e.jsx(l,{label:"Titre du voyage *",name:"title",value:r.title,onChange:i,placeholder:"Ex: Voyage d'affaires Dakar - Abidjan",required:!0}),e.jsx("textarea",{name:"description",value:r.description,onChange:i,rows:4,className:"w-full px-4 py-3 border border-neutral-300 rounded-2xl shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary resize-none",placeholder:"Ajoutez des détails sur votre voyage (horaires, flexibilité, etc.)"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(q,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800",children:"Itinéraire"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs(h,{label:"Pays de départ *",name:"departure_country",value:r.departure_country,onChange:a=>b(a,"departure"),required:!0,children:[e.jsx("option",{value:"",children:"Choisir un pays"}),v.map(a=>e.jsx("option",{value:a.name,children:a.name},a.iso2))]})}),e.jsx("div",{children:e.jsx(l,{label:"Ville de départ *",name:"departure_city",value:r.departure_city,onChange:i,required:!0,placeholder:"Ex: Dakar"})}),e.jsx("div",{children:e.jsxs(h,{label:"Pays d'arrivée *",name:"arrival_country",value:r.arrival_country,onChange:a=>b(a,"arrival"),required:!0,children:[e.jsx("option",{value:"",children:"Choisir un pays"}),v.map(a=>e.jsx("option",{value:a.name,children:a.name},a.iso2))]})}),e.jsx("div",{children:e.jsx(l,{label:"Ville d'arrivée *",name:"arrival_city",value:r.arrival_city,onChange:i,required:!0,placeholder:"Ex: Abidjan"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(z,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800",children:"Dates"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"Date de départ *",name:"departure_date",type:"date",value:r.departure_date,onChange:i,required:!0}),e.jsx(l,{label:"Date d'arrivée *",name:"arrival_date",type:"date",value:r.arrival_date,onChange:i,required:!0})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(T,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800",children:"Capacité et Prix"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"Poids disponible (kg) *",name:"available_weight",type:"number",step:"0.5",min:"0.5",value:r.available_weight,onChange:i,placeholder:"Ex: 10",required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(l,{label:"Prix par kg *",name:"price_per_kg",type:"number",step:"100",min:"0",value:r.price_per_kg,onChange:i,placeholder:"Ex: 5000",required:!0}),e.jsx(h,{label:"Devise *",name:"currency",value:r.currency,onChange:i,required:!0,children:U.map(a=>e.jsxs("option",{value:a.code,children:[a.name," (",a.code,")"]},a.code))})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[e.jsx(D,{type:"button",variant:"outline",onClick:()=>d("/dashboard"),className:"flex-1 py-3 text-base",children:"Annuler"}),e.jsx(D,{type:"submit",loading:A,className:"flex-1 bg-primary hover:bg-primary/90 text-white py-3 text-base font-semibold",children:"Publier le voyage"})]})]})}function Q(){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-screen bg-neutral-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-neutral-800 mb-4",children:"Publier une nouvelle annonce de voyage"}),e.jsx("p",{className:"text-lg text-neutral-600 max-w-2xl mx-auto",children:"Partagez les détails de votre prochain voyage pour recevoir des demandes de transport de colis et rentabiliser votre trajet."})]}),e.jsx("div",{className:"bg-white rounded-4xl shadow-xl p-8",children:e.jsx(Z,{})})]})})})}export{Q as CreateTripPage};
