import{r as s,j as e,B as j,s as y}from"./index-s1Im0gGd.js";import{A as c}from"./Alert-DQovq92X.js";import{S as w}from"./star-28KIeG3b.js";function k({transactionId:u,revieweeId:m,reviewerId:d,onReviewSubmitted:x}){const[o,f]=s.useState(0),[a,p]=s.useState(""),[b,i]=s.useState(!1),[l,n]=s.useState(""),[v,h]=s.useState(!1),g=async t=>{if(t.preventDefault(),o===0){n("Veuillez sélectionner une note.");return}i(!0),n("");try{const{error:r}=await y.from("reviews").insert({transaction_id:u,reviewee_id:m,reviewer_id:d,rating:o,comment:a});if(r)throw r;h(!0),setTimeout(()=>{x()},1500)}catch(r){n("Une erreur est survenue lors de la soumission de l'avis."),console.error(r)}finally{i(!1)}};return v?e.jsx(c,{type:"success",title:"Avis envoyé !",message:"Merci pour votre contribution."}):e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[l&&e.jsx(c,{type:"error",message:l}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-neutral-800 mb-3",children:"Votre note"}),e.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>f(t),className:"focus:outline-none",children:e.jsx(w,{className:`w-8 h-8 transition-colors ${t<=o?"text-yellow-400 fill-current":"text-neutral-300"}`})},t))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comment",className:"block text-lg font-semibold text-neutral-800 mb-3",children:"Votre commentaire (optionnel)"}),e.jsx("textarea",{id:"comment",value:a,onChange:t=>p(t.target.value),rows:5,className:"w-full px-4 py-3 border border-neutral-300 rounded-2xl shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary resize-none",placeholder:"Partagez votre expérience..."})]}),e.jsx(j,{type:"submit",loading:b,className:"w-full py-3 text-base font-semibold",children:"Soumettre l'avis"})]})}export{k as L};
