import{u as D,b as C,r as l,j as e,B as g,s as w}from"./index-s1Im0gGd.js";import{I as t}from"./Input-BKp795_O.js";import{A}from"./Alert-DQovq92X.js";import{c as F,S as m}from"./countries_cities-BAqQKpta.js";import{P as b}from"./package-D_gg4fgx.js";import{M as R}from"./map-pin-CGMQsRrg.js";import{R as k}from"./ruler-DCue6X6r.js";import{D as E}from"./dollar-sign-CLdPlu9-.js";const L=[{code:"XOF",name:"Franc CFA (BCEAO)"},{code:"XAF",name:"Franc CFA (BEAC)"},{code:"DZD",name:"Dinar Algérien"},{code:"AOA",name:"Kwanza Angolais"},{code:"BWP",name:"Pula Botswanais"},{code:"BIF",name:"Franc Burundais"},{code:"CVE",name:"Escudo Cap-Verdien"},{code:"KMF",name:"Franc Comorien"},{code:"CDF",name:"Franc Congolais"},{code:"DJF",name:"Franc Djiboutien"},{code:"EGP",name:"Livre Égyptienne"},{code:"ERN",name:"Nakfa Érythréen"},{code:"ETB",name:"Birr Éthiopien"},{code:"GMD",name:"Dalasi Gambien"},{code:"GHS",name:"Cedi Ghanéen"},{code:"GNF",name:"Franc Guinéen"},{code:"KES",name:"Shilling Kenyan"},{code:"LSL",name:"Loti Lesothan"},{code:"LRD",name:"Dollar Libérien"},{code:"LYD",name:"Dinar Libyen"},{code:"MGA",name:"Ariary Malgache"},{code:"MWK",name:"Kwacha Malawite"},{code:"MRU",name:"Ouguiya Mauritanien"},{code:"MUR",name:"Roupie Mauricienne"},{code:"MAD",name:"Dirham Marocain"},{code:"MZN",name:"Metical Mozambicain"},{code:"NAD",name:"Dollar Namibien"},{code:"NGN",name:"Naira Nigérian"},{code:"RWF",name:"Franc Rwandais"},{code:"STN",name:"Dobra Santoméen"},{code:"SCR",name:"Roupie Seychelloise"},{code:"SLE",name:"Leone Sierra-Léonais"},{code:"SOS",name:"Shilling Somali"},{code:"ZAR",name:"Rand Sud-Africain"},{code:"SSP",name:"Livre Sud-Soudanaise"},{code:"SDG",name:"Livre Soudanaise"},{code:"SZL",name:"Lilangeni Swazi"},{code:"TZS",name:"Shilling Tanzanien"},{code:"TND",name:"Dinar Tunisien"},{code:"UGX",name:"Shilling Ougandais"},{code:"ZMW",name:"Kwacha Zambien"},{code:"ZWL",name:"Dollar Zimbabwéen"},{code:"USD",name:"Dollar Américain"},{code:"EUR",name:"Euro"},{code:"GBP",name:"Livre Sterling"},{code:"CAD",name:"Dollar Canadien"},{code:"CHF",name:"Franc Suisse"},{code:"CNY",name:"Yuan Chinois"},{code:"JPY",name:"Yen Japonais"},{code:"AUD",name:"Dollar Australien"},{code:"INR",name:"Roupie Indienne"},{code:"BRL",name:"Réal Brésilien"},{code:"RUB",name:"Rouble Russe"},{code:"AED",name:"Dirham des É.A.U."},{code:"SAR",name:"Riyal Saoudien"}];function M(){const{user:u}=D(),p=C(),[a,o]=l.useState({title:"",description:"",pickup_city:"",pickup_country:"",delivery_city:"",delivery_country:"",weight:"",length:"",width:"",height:"",proposed_price:"",currency:""}),[h,j]=l.useState([]),[N,x]=l.useState(!1),[y,d]=l.useState(""),[f,S]=l.useState(!1);l.useEffect(()=>{const n=[...F].sort((i,s)=>i.name.localeCompare(s.name));j(n)},[]);const r=n=>{const{name:i,value:s}=n.target;o(c=>({...c,[i]:s}))},v=(n,i)=>{const s=n.target.value;o(i==="pickup"?c=>({...c,pickup_country:s,pickup_city:""}):c=>({...c,delivery_country:s,delivery_city:""}))},_=async n=>{if(n.preventDefault(),!u){d("Vous devez être connecté pour publier une annonce");return}x(!0),d("");try{if(!a.title||!a.pickup_city||!a.pickup_country||!a.delivery_city||!a.delivery_country||!a.weight||!a.proposed_price||!a.currency)throw new Error("Veuillez remplir tous les champs obligatoires");const i={sender_id:u.id,title:a.title,description:a.description||null,pickup_city:a.pickup_city,pickup_country:a.pickup_country,delivery_city:a.delivery_city,delivery_country:a.delivery_country,pickup_address:`${a.pickup_city}, ${a.pickup_country}`,delivery_address:`${a.delivery_city}, ${a.delivery_country}`,weight:parseFloat(a.weight),length:a.length?parseFloat(a.length):null,width:a.width?parseFloat(a.width):null,height:a.height?parseFloat(a.height):null,proposed_price:parseFloat(a.proposed_price),currency:a.currency,status:"PENDING_MATCH"},{error:s}=await w.from("shipments").insert([i]);if(s)throw s;S(!0),setTimeout(()=>{p("/dashboard")},2e3)}catch(i){console.error("Erreur lors de la création de l'annonce:",i),d(i.message||"Une erreur est survenue lors de la publication de votre annonce")}finally{x(!1)}};return f?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(b,{className:"w-8 h-8 text-green-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-neutral-800 mb-2",children:"Annonce publiée avec succès !"}),e.jsx("p",{className:"text-neutral-600 mb-4",children:"Votre annonce est maintenant visible par les voyageurs. Vous serez notifié dès qu'un voyageur sera intéressé."}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Redirection vers le tableau de bord..."})]}):e.jsxs("form",{onSubmit:_,className:"space-y-8",children:[y&&e.jsx(A,{type:"error",message:y}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(b,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800",children:"Informations du colis"})]}),e.jsx(t,{label:"Titre de l'annonce *",name:"title",value:a.title,onChange:r,placeholder:"Ex: iPhone 15 Pro Max neuf",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:a.description,onChange:r,rows:4,className:"w-full px-4 py-3 border border-neutral-300 rounded-2xl shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary resize-none",placeholder:"Décrivez votre colis en détail (état, contenu, précautions particulières...)"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(R,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800",children:"Itinéraire"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-neutral-700",children:"Point de départ"}),e.jsxs(m,{label:"Pays de départ *",name:"pickup_country",value:a.pickup_country,onChange:n=>v(n,"pickup"),required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Choisir un pays"}),h.map(n=>e.jsx("option",{value:n.name,children:n.name},n.iso2))]}),e.jsx(t,{label:"Ville de départ *",name:"pickup_city",value:a.pickup_city,onChange:r,required:!0,placeholder:"Ex: Dakar",disabled:!a.pickup_country})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-neutral-700",children:"Destination"}),e.jsxs(m,{label:"Pays d'arrivée *",name:"delivery_country",value:a.delivery_country,onChange:n=>v(n,"delivery"),required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Choisir un pays"}),h.map(n=>e.jsx("option",{value:n.name,children:n.name},n.iso2))]}),e.jsx(t,{label:"Ville d'arrivée *",name:"delivery_city",value:a.delivery_city,onChange:r,required:!0,placeholder:"Ex: Abidjan",disabled:!a.delivery_country})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(k,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800",children:"Dimensions et poids"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx(t,{label:"Poids (kg) *",name:"weight",type:"number",step:"0.1",min:"0.1",value:a.weight,onChange:r,placeholder:"Ex: 0.5",required:!0}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:"Dimensions (cm) - Optionnel"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(t,{name:"length",type:"number",step:"0.1",min:"0",value:a.length,onChange:r,placeholder:"Longueur"}),e.jsx(t,{name:"width",type:"number",step:"0.1",min:"0",value:a.width,onChange:r,placeholder:"Largeur"}),e.jsx(t,{name:"height",type:"number",step:"0.1",min:"0",value:a.height,onChange:r,placeholder:"Hauteur"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(E,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800",children:"Récompense"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsx(t,{label:"Récompense proposée *",name:"proposed_price",type:"number",min:"1",step:"any",value:a.proposed_price,onChange:r,placeholder:"Ex: 25000",required:!0}),e.jsxs(m,{label:"Devise *",name:"currency",value:a.currency,onChange:r,required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Choisir une devise"}),L.map(n=>e.jsxs("option",{value:n.code,children:[n.name," (",n.code,")"]},n.code))]})]}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Montant que vous êtes prêt à payer pour le transport de votre colis."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>p("/dashboard"),className:"flex-1 py-3 text-base",children:"Annuler"}),e.jsx(g,{type:"submit",loading:N,className:"flex-1 bg-primary hover:bg-primary/90 text-white py-3 text-base font-semibold",children:"Publier l'annonce"})]})]})}function Z(){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-screen bg-neutral-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-neutral-800 mb-4",children:"Publier une nouvelle annonce de colis"}),e.jsx("p",{className:"text-lg text-neutral-600 max-w-2xl mx-auto",children:"Remplissez les informations de votre colis pour trouver un voyageur de confiance qui pourra le transporter en toute sécurité."})]}),e.jsx("div",{className:"bg-white rounded-4xl shadow-xl p-8",children:e.jsx(M,{})})]})})})}export{Z as CreateShipmentPage};
