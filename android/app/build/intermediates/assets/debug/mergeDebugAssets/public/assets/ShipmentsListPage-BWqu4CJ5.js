import{r as t,j as e,B as j,L as v,s as N}from"./index-s1Im0gGd.js";import{S as b}from"./ShipmentCard--3z7VJzP.js";import{I as x}from"./Input-BKp795_O.js";import{S as y}from"./search-DZtwayj2.js";import{S}from"./server-crash-DZrP2UOO.js";import{P as w}from"./package-D_gg4fgx.js";import"./map-pin-CGMQsRrg.js";import"./calendar-8PhAnDAA.js";import"./dollar-sign-CLdPlu9-.js";function z(){const[l,u]=t.useState([]),[i,n]=t.useState(!0),[c,o]=t.useState(""),[s,h]=t.useState(""),[a,p]=t.useState(""),m=async()=>{try{n(!0),o("");let r=N.from("shipments").select("*").eq("status","PENDING_MATCH").order("created_at",{ascending:!1});s&&(r=r.ilike("pickup_city",`%${s}%`)),a&&(r=r.ilike("delivery_city",`%${a}%`));const{data:f,error:d}=await r;if(d)throw d;u(f||[])}catch(r){o("Erreur lors du chargement des annonces de colis."),console.error("Error fetching shipments:",r)}finally{n(!1)}};t.useEffect(()=>{m()},[]);const g=r=>{r.preventDefault(),m()};return e.jsx("div",{className:"min-h-screen bg-neutral-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-neutral-800 mb-4",children:"Trouver un colis à transporter"}),e.jsx("p",{className:"text-xl text-neutral-600 max-w-3xl mx-auto",children:"Parcourez les annonces et trouvez des colis qui correspondent à votre itinéraire."})]}),e.jsx("div",{className:"bg-white rounded-4xl shadow-lg p-6 mb-12 max-w-4xl mx-auto",children:e.jsxs("form",{onSubmit:g,className:"grid sm:grid-cols-3 gap-4 items-end",children:[e.jsx(x,{label:"Ville de départ",value:s,onChange:r=>h(r.target.value),placeholder:"Ex: Dakar"}),e.jsx(x,{label:"Ville d'arrivée",value:a,onChange:r=>p(r.target.value),placeholder:"Ex: Abidjan"}),e.jsxs(j,{type:"submit",className:"w-full h-12 text-base bg-primary hover:bg-primary/90 text-white",loading:i,children:[e.jsx(y,{className:"w-5 h-5 mr-2"}),"Rechercher"]})]})}),i?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(v,{className:"w-12 h-12 text-primary animate-spin"})}):c?e.jsxs("div",{className:"text-center py-20 bg-red-50 rounded-2xl",children:[e.jsx(S,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-red-700",children:"Oops! Une erreur est survenue."}),e.jsx("p",{className:"text-red-600 mt-2",children:c})]}):l.length===0?e.jsxs("div",{className:"text-center py-20 bg-neutral-100 rounded-2xl",children:[e.jsx(w,{className:"w-12 h-12 text-neutral-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-700",children:"Aucune annonce trouvée"}),e.jsx("p",{className:"text-neutral-500 mt-2",children:"Essayez d'élargir vos critères de recherche."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:l.map(r=>e.jsx(b,{shipment:r},r.id))})]})})}export{z as ShipmentsListPage};
