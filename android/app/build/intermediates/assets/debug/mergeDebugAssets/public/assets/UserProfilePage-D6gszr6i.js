import{g as P,r as a,j as e,L as R,U as D,s as n}from"./index-s1Im0gGd.js";import{S as E}from"./ShipmentCard--3z7VJzP.js";import{T as L}from"./TripCard-DomRgofk.js";import{S as k}from"./server-crash-DZrP2UOO.js";import{S as q}from"./shield-check-DElasyHW.js";import{S as c}from"./star-28KIeG3b.js";import{P as N}from"./package-D_gg4fgx.js";import{B as b}from"./briefcase-DOTPYjiq.js";import"./map-pin-CGMQsRrg.js";import"./calendar-8PhAnDAA.js";import"./dollar-sign-CLdPlu9-.js";import"./weight-h7E0NLn2.js";function H(){const{id:l}=P(),[s,v]=a.useState(null),[m,w]=a.useState([]),[d,_]=a.useState([]),[u,y]=a.useState([]),[S,f]=a.useState(!0),[p,j]=a.useState(null);a.useEffect(()=>{(async()=>{if(l)try{f(!0),j(null);const[r,i,o,h]=await Promise.all([n.from("users").select("id, first_name, last_name, profile_picture, created_at, kyc_status, average_rating, review_count").eq("id",l).single(),n.from("shipments").select("*").eq("sender_id",l).order("created_at",{ascending:!1}),n.from("trips").select("*, traveler:users!traveler_id(first_name, last_name, profile_picture)").eq("traveler_id",l).order("created_at",{ascending:!1}),n.from("reviews").select("*, reviewer:users!reviews_reviewer_id_fkey(first_name, last_name)").eq("reviewee_id",l).order("created_at",{ascending:!1})]);if(r.error)throw new Error("Profil utilisateur non trouvé.");if(v(r.data),i.error)throw i.error;if(w(i.data||[]),o.error)throw o.error;if(_(o.data||[]),h.error)throw h.error;y(h.data||[])}catch(r){j("Impossible de charger le profil."),console.error(r)}finally{f(!1)}})()},[l]);const g=(s==null?void 0:s.average_rating)||0,x=(s==null?void 0:s.review_count)||0;return S?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(R,{className:"w-12 h-12 text-primary animate-spin"})}):p||!s?e.jsxs("div",{className:"min-h-screen bg-neutral-50 py-12 px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx(k,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-red-700",children:"Profil non trouvé"}),e.jsx("p",{className:"text-red-600 mt-2",children:p||"L'utilisateur que vous cherchez n'existe pas."})]}):e.jsx("div",{className:"min-h-screen bg-neutral-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-4xl shadow-xl p-8 mb-12",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-8",children:[s.profile_picture?e.jsx("img",{src:s.profile_picture,alt:"Profil",className:"w-32 h-32 rounded-full object-cover border-4 border-primary"}):e.jsx("div",{className:"w-32 h-32 rounded-full bg-neutral-200 flex items-center justify-center border-4 border-primary",children:e.jsx(D,{className:"w-16 h-16 text-neutral-500"})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsxs("div",{className:"flex items-center justify-center sm:justify-start gap-4",children:[e.jsxs("h1",{className:"text-4xl font-bold text-neutral-800",children:[s.first_name," ",s.last_name]}),s.kyc_status==="VERIFIED"&&e.jsxs("span",{className:"flex items-center bg-green-100 text-green-800 text-sm font-medium px-3 py-1 rounded-full",children:[e.jsx(q,{className:"w-4 h-4 mr-1.5"}),"Identité Vérifiée"]})]}),e.jsxs("p",{className:"text-neutral-500 mt-2",children:["Membre depuis ",new Date(s.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long"})]}),e.jsxs("div",{className:"flex items-center justify-center sm:justify-start gap-2 mt-3 text-lg",children:[e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((t,r)=>e.jsx(c,{className:`w-6 h-6 ${r<g?"text-yellow-400 fill-current":"text-neutral-300"}`},r))}),e.jsx("span",{className:"font-bold text-neutral-700",children:g.toFixed(1)}),e.jsxs("span",{className:"text-neutral-500",children:["(",x," avis)"]})]})]})]})}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(c,{className:"w-6 h-6 text-accent mr-3"}),e.jsxs("h2",{className:"text-2xl font-bold text-neutral-800",children:["Avis reçus (",x,")"]})]}),u.length>0?e.jsx("div",{className:"space-y-6",children:u.map(t=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"font-semibold",children:[t.reviewer.first_name," ",t.reviewer.last_name]}),e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,i)=>e.jsx(c,{className:`w-5 h-5 ${i<t.rating?"text-yellow-400 fill-current":"text-neutral-300"}`},i))})]}),e.jsxs("p",{className:"text-neutral-600 italic",children:['"',t.comment,'"']}),e.jsx("p",{className:"text-xs text-neutral-500 mt-2",children:new Date(t.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]},t.id))}):e.jsx("div",{className:"text-center py-12 bg-white rounded-2xl border",children:e.jsxs("p",{className:"text-neutral-600",children:[s.first_name," n'a pas encore reçu d'avis."]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 text-center mb-12",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:[e.jsx(N,{className:"w-10 h-10 text-accent mx-auto mb-3"}),e.jsx("p",{className:"text-3xl font-bold text-neutral-800",children:m.length}),e.jsx("p",{className:"text-neutral-600",children:"Colis envoyés"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:[e.jsx(b,{className:"w-10 h-10 text-accent mx-auto mb-3"}),e.jsx("p",{className:"text-3xl font-bold text-neutral-800",children:d.length}),e.jsx("p",{className:"text-neutral-600",children:"Voyages effectués"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:[e.jsx(c,{className:"w-10 h-10 text-accent mx-auto mb-3"}),e.jsx("p",{className:"text-3xl font-bold text-neutral-800",children:x}),e.jsx("p",{className:"text-neutral-600",children:"Avis reçus"})]})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(N,{className:"w-6 h-6 text-accent mr-3"}),e.jsxs("h2",{className:"text-2xl font-bold text-neutral-800",children:["Annonces publiées par ",s.first_name]})]}),m.length>0?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:m.map(t=>e.jsx(E,{shipment:t},t.id))}):e.jsx("div",{className:"text-center py-12 bg-white rounded-2xl border",children:e.jsxs("p",{className:"text-neutral-600",children:[s.first_name," n'a publié aucune annonce de colis pour le moment."]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(b,{className:"w-6 h-6 text-accent mr-3"}),e.jsxs("h2",{className:"text-2xl font-bold text-neutral-800",children:["Trajets publiés par ",s.first_name]})]}),d.length>0?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:d.map(t=>e.jsx(L,{trip:t},t.id))}):e.jsx("div",{className:"text-center py-12 bg-white rounded-2xl border",children:e.jsxs("p",{className:"text-neutral-600",children:[s.first_name," n'a publié aucun trajet pour le moment."]})})]})]})})}export{H as UserProfilePage};
